<!DOCTYPE html>
<html><head><!-- META --><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1"><title>Telemetry tips</title><meta name="description" content="When getting started with a new telemetry platform you may not know what conventions you need to set and follow for metrics, logs, code, etc.. Even if you do, how do you get the rest of the team to follow them too."><meta name="author" content="Devon Burriss"><link rel="canonical" href="https://devonburriss.me/telemetry-tips/"><meta itemprop="datePublished" content="2022-06-15" id="date"><meta itemprop="dateModified" content="2022-06-15" id="mdate"><meta itemprop="headline" content="Telemetry tips - Some tips to keep your telemetry data and code clean"><meta itemprop="mainEntityOfPage" content="https://devonburriss.me/telemetry-tips/"><meta name="headline" content="Telemetry tips - Some tips to keep your telemetry data and code clean"><link rel="icon" type="image/png" href="/img/favicon16.png" sizes="16x16"><link rel="icon" type="image/png" href="/img/favicon32.png" sizes="32x32"><meta itemprop="name" content="Telemetry tips"><meta itemprop="description" content="When getting started with a new telemetry platform you may not know what conventions you need to set and follow for metrics, logs, code, etc.. Even if you do, how do you get the rest of the team to follow them too."><meta itemprop="image" content="https://devonburriss.me/img/posts/2018/pipes-500.jpg"><meta name="twitter:card" content="summary_large_image"><meta name="twitter:site" content="@DevonBurriss"><meta name="twitter:title" content="Telemetry tips"><meta name="twitter:description" content="When getting started with a new telemetry platform you may not know what conventions you need to set and follow for metrics, logs, code, etc.. Even if you do, how do you get the rest of the team to follow them too."><meta name="twitter:creator" content="@DevonBurriss"><meta name="twitter:image" content="https://devonburriss.me/img/posts/2018/pipes-500.jpg"><meta property="og:title" content="Telemetry tips"><meta property="og:type" content="article"><meta property="og:url" content="https://devonburriss.me/telemetry-tips/"><meta property="og:image" content="https://devonburriss.me/img/posts/2018/pipes-500.jpg"><meta property="og:description" content="When getting started with a new telemetry platform you may not know what conventions you need to set and follow for metrics, logs, code, etc.. Even if you do, how do you get the rest of the team to follow them too."><meta property="og:site_name" content="Devon Burriss&#39; Blog"><link rel="stylesheet" href="/css/bootstrap.min.css"><link rel="stylesheet" href="/css/clean-blog.css"><link rel="stylesheet" charset="UTF-8" href="/css/highlight/atom-one-light.css"><link href="//maxcdn.bootstrapcdn.com/font-awesome/4.3.0/css/font-awesome.min.css" rel="stylesheet" type="text/css"><link href="//fonts.googleapis.com/css?family=Lora:400,700,400italic,700italic" rel="stylesheet" type="text/css"><link href="//fonts.googleapis.com/css?family=Open+Sans:300italic,400italic,600italic,700italic,800italic,400,300,600,700,800" rel="stylesheet" type="text/css"><!--[if lt IE 9]>
        <script src="https://oss.maxcdn.com/libs/html5shiv/3.7.0/html5shiv.js"></script>
        <script src="https://oss.maxcdn.com/libs/respond.js/1.4.2/respond.min.js"></script>
    <![endif]--></head><body><nav class="navbar navbar-default navbar-custom navbar-fixed-top"><div class="container-fluid"><div class="navbar-header page-scroll"><button type="button" class="navbar-toggle" data-toggle="collapse" data-target="#bs-example-navbar-collapse-1"><span class="sr-only">Toggle navigation</span><span class="icon-bar"></span><span class="icon-bar"></span><span class="icon-bar"></span></button><a class="navbar-brand" href="/">Devon Burriss&#39; Blog</a></div><div class="collapse navbar-collapse" id="bs-example-navbar-collapse-1"><ul class="nav navbar-nav navbar-right"><li><a href="/">Home</a></li><li><a href="/recommended-reading.html">Recommended Reading</a></li><li><a href="/rss.xml"><span class="fa-stack fa-lg"><i class="fa fa-rss fa-stack-1x"></i></span></a></li></ul></div></div></nav><header class="intro-header" style="background-image: url(&#39;/img/backgrounds/star-watch-bg.jpg&#39;)"><div class="container-fluid"><div class="row"><div class="col-lg-8 col-lg-offset-2 col-md-10 col-md-offset-1"><div class="post-heading"><div class="frame"><h1>Telemetry tips</h1><h2 class="subheading">Some tips to keep your telemetry data and code clean</h2><span class="meta" itemprop="author" itemscope="" itemtype="https://schema.org/Person">Posted by <span itemprop="name">Devon Burriss</span> on June 15, 2022</span><span style="display:contents"><hr><a href="/topics/reliability-observability/" title="Monitoring, metrics, reliability, and failure modes."><span class="label label-default">Reliability &amp; Observability</span></a></span><div></div></div></div></div></div></div></header><article><div class="container-fluid"><div class="row"><div class="col-lg-8"><p>When getting started with a new telemetry platform you may not know what conventions you need to set and follow. Even if you do, how do you get the rest of the team to follow them too. In this post I will give some tips for making sure the data hitting your telemetry tool is clean and organised so you can make the most of it, while not compromising the readability of your application code.</p>
<!--more-->
<h2 id="define-metric-and-tagging-conventions-early">Define metric and tagging conventions early</h2>
<p>Anyone who has used a telemetry tool like Datadog in an organisation where the conventions are not clear will recognise the problem this is trying to solve. As teams start sending data, searching for anything becomes difficult as you sort through metrics ranging from <code>AcmeCoolServiceStartedUp</code> to <code>record_updated</code>. This can quickly get out of hand and can make searching for metrics quite frustrating. Since we want to make working with telemetry as [easy as possible], I suggest you tackle this as soon as possible.</p>
<p>Here are some of my recommendations:</p>
<ul>
<li>Use lowercase <code>snake_case</code> for metrics and and lowercase <code>kebab-case</code> tags. Reasons: Avoid case sensitive search issues. Readability.</li>
<li>Consider namespacing your metrics if you foresee multiple complex domains with lots of unique metrics eg. <code>some_domain.some_app_some_metric</code></li>
<li>Make use of key-value pairs in tags eg. <code>env:prod</code></li>
<li>Be clear on reserved tags eg. <code>env:prod</code> and <code>service:app-name</code></li>
<li>Use <code>result:success</code> and <code>result:fail</code> tags on the same metric rather than 2 separate metrics</li>
</ul>
<p>When running in the cloud, like many are, an important part of tagging that is easy to overlook is your infrastructure tagging. A system like <a href="https://docs.datadoghq.com/">Datadog</a> will pull tags from your cloud infrastructure resources and attach them to the metrics sent from that resource. This is why it is important to match your metric tagging and cloud infrastructure tagging conventions.</p>
<p>Infrastructure tags to consider:</p>
<ul>
<li>The environment as an <code>env</code> tag</li>
<li>The <code>service</code> sending telemetry</li>
<li>The <code>version</code> of the deployed application/service</li>
<li>You may want one or more of the following: <code>cost-centre</code> / <code>department</code> / <code>domain</code></li>
<li>The team to contact for support with the resource <code>team:team-name</code></li>
<li>The SLA for the application</li>
<li>The criticality of the application for the health of your system ranging from <code>criticality:very-high</code> to <code>criticality:low</code></li>
<li>The tool used to created eg. <code>tool:farmer</code></li>
<li>Dates like <code>created-at:2022-05-22</code> and <code>updated-at:2022-05-30</code></li>
</ul>
<p>Telemetry tools often require some of these to be useful. <code>env</code>, <code>service</code> and <code>version</code> are part of <a href="https://docs.datadoghq.com/getting_started/tagging/unified_service_tagging">unified service tagging</a> for Datadog. Check what yours are for your telemetry tool.</p>
<p>This is not an exhaustive list but will hopefully give you a starting point.</p>
<h2 id="build-up-tooling-to-help-with-standards">Build up tooling to help with standards</h2>
<p>Tooling for helping developers fall into the pit of success with the configuration and tagging of metrics can go a long way.</p>
<p>One such example is a thin wrapper around application setup that enforces the setup and sending of a service name, environment, etc. Often these things can be handled by the host environment but if not it is worth the small effort.</p>
<p>Rather than having each new project require configuring the application telemetry just right, make some sort of template, snippet, or package available to help developers fall into the pit of success.</p>
<pre><code class="language-csharp">// ASP.NET Program.cs
var builder = WebApplication.CreateBuilder(args);
builder.AddTelemetry();
// other setup...
</code></pre>
<p>The example above relies on environment variables being present but your solution could require they are passed in. The important part is making it easy to do right and provide clear guidance if something is wrong. For example, the <code>AddTelemetry</code> method will explicitly check that all expected environment variables are present and throw an error with a clear list of all missing environment variable names.</p>
<pre><code class="language-csharp">missing.EnvVarCheck(&quot;DD_API_KEY&quot;, &quot;Set `DD_API_KEY` with your Datadog API key.&quot;);
missing.EnvVarCheck(&quot;DD_ENV&quot;, &quot;Set `DD_ENV` with the name of the current environment eg. prod&quot;);
missing.EnvVarCheck(&quot;DD_SERVICE&quot;, &quot;Set `DD_SERVICE` with the name of this service.&quot;);
// etc.
</code></pre>
<p>The important takeaway is to make it easy to setup correctly, and give clear feedback when something is wrong.</p>
<p>The next helper that you can introduce is some way to make metric names discoverable.</p>
<pre><code class="language-csharp">public static class MetricName
{
    public const string TodoListCreated = &quot;observability_project.todo.list_created&quot;;
    public const string TodoListCount = &quot;observability_project.todo.list_count&quot;;
}
</code></pre>
<p>This may seem like a chore but it does have some advantages. You now have a repeatable way for developers to find a metric name via intellisense. You have a single place to change a metric name if you really needed to. And an often overlooked benefit is you have an overview of all metrics possibly sent and an IDE enabled way to find from where.</p>
<p>The same arguments can be made for tags. Remember that tags should always be of a fixed set, and so capturing them in code should be possible. If you are using an almost unconstrained range like a database identifier as a tag, expect a large bill from your telemetry provider for excessive indexes. Having them easily discoverable means you don't have multiple tags used for the same thing eg. <code>result:fail</code>, <code>result:failure</code>, and <code>result:error</code>.</p>
<pre><code class="language-csharp">public static class Tag
{
    public const string Success = &quot;result:success&quot;;
    public const string Failure = &quot;result:failure&quot;;
}
</code></pre>
<p>If you decide not to go with a static list like above, at least introduce some kind of check that helps point out poorly conforming metrics and tags.</p>
<h2 id="enable-metric-and-log-correlation">Enable metric and log correlation</h2>
<p>The true power of modern telemetry solutions is in the correlation of traces and logs through identifiers that allow correlation between parent and child processes, even across network boundaries. Hopefully most of you would have seen this in action already but if not, it unlocks another level of observability in your applications.</p>
<p><img src="../img/posts/2022/2022-06-14-21-44-08.png" alt="APM with linked logs" /></p>
<p>Above you can see we not only have a nice trace representing our request, we also all the logs linked to said request through the trace. It can often be some work to make sure these trace and span identifiers are flowing through your system well but when they are it is magic.</p>
<p>For many stacks these traces are injected in HTTP headers and so will carry across network boundaries. Sometimes you need you need to <a href="https://docs.datadoghq.com/tracing/connect_logs_and_traces/dotnet/?tab=serilog">configure them manually</a> and depending on your tooling and stack it may be as simple as installing a package. For a message queue, you will probably need to do some manual work to propagate a trace.</p>
<h2 id="dont-mix-telemetry-code-and-application-code">Don't mix telemetry code and application code</h2>
<p>Instead of littering your code with random logs and metric pushes, I suggest starting with &quot;what happened?&quot;. Once you have a call defining what happened, you decide what telemetry to send internally. This is better explained with an example:</p>
<pre><code class="language-csharp">DogStatsd.Set(&quot;observability_project.todo.list_count&quot;, dataStore.Count);
if (dataStore.Count == 0)
{
    logger.LogInformation(&quot;TODO lists requested but none found.&quot;);
    return (new List&lt;TodoList&gt;());
}
return dataStore.Values.ToList();
</code></pre>
<p>In the snippet above, we have metric and logging code scattered around our application code. This can be better refactored into telemetry calls saying WHAT happened, and we place the metric sending and logging within the method.</p>
<pre><code class="language-csharp">if (dataStore.Count == 0)
{
    telemetryEvents.NoListsReturned();
    return (new List&lt;TodoList&gt;());
}
telemetryEvents.ListsAvailable(dataStore.Count);
return dataStore.Values.ToList();
</code></pre>
<p>A complaint I have heard a few times with this approach is that logging and metrics are not the same so they shouldn't be bundled together this way. There are a few arguments to make here but instead I will ask a few questions. Is the code clearer because of this change? Will the core application logic change less frequently for unrelated reasons like adding a log?</p>
<p>If you are interested, an old colleague, <a href="https://www.erikheemskerk.nl/meaningful-logging-and-metrics/">Erik Heemskerk wrote this up in more detail</a>.</p>
<h2 id="instrument-where-the-action-happens">Instrument where the action happens</h2>
<p>This is more a rule of thumb (no Sopranos here so no fingers will be broken if you ignore it). My suggestion is to try and keep the sending of telemetry to the boundaries of your application. Place them where calls come into your application and where calls go out to databases or other network calls.</p>
<p>What you want to try do is keep them out of your core domain calculations. Sometimes, if your domain is complex enough it may be worth the odd call to that logs some information. Mostly though, metrics are about something happened, and it didn't really happen until your application interacts with the outside world.</p>
<h2 id="conclusion">Conclusion</h2>
<p>I touched on a few ways you can set a team up for success when using a telemetry tool. There are plenty of things to learn and maybe I will do more posts on the subject. Good luck on your telemetry journey. Feel free to hit me up on <a href="https://twitter.com/DevonBurriss">Twitter</a> with your tips.</p>
<h2 id="resources">Resources</h2>
<ul>
<li><a href="https://jimmybogard.com/building-end-to-end-diagnostics-opentelemetry-integration/">A great series on OpenTelemetry</a></li>
<li><a href="https://docs.datadoghq.com/getting_started/tagging/">Datadog tagging</a></li>
<li><a href="https://docs.microsoft.com/en-us/azure/cloud-adoption-framework/ready/azure-best-practices/naming-and-tagging">Azure naming and tagging</a></li>
<li><a href="https://opentelemetry.io/docs/reference/specification/metrics/semantic_conventions/">Open metrics</a></li>
<li><a href="https://opentelemetry.io/docs/reference/specification/common/attribute-naming/">OpenTelemetry attribute</a></li>
</ul>
<hr><ul class="pager"><li class="previous"><a href="/choosing-a-telemetry-platform/" data-toggle="tooltip" data-placement="top" title="Choosing a telemetry platform">&larr; Previous Post</a></li><li class="next"><a href="/yagnyagni/" data-toggle="tooltip" data-placement="top" title="You ain&#39;t gonna need YAGNI">Next Post &rarr;</a></li></ul></div><div class="col-lg-4 widget-column"><ul class="list-inline text-center"><li><a href="/rss.xml"><span class="fa-stack fa-lg"><i class="fa fa-square fa-stack-2x"></i><i class="fa fa-rss fa-stack-1x fa-inverse"></i></span></a></li><li><a href="/atom.xml"><span class="fa-stack fa-lg"><i class="fa fa-circle fa-stack-2x"></i><i class="fa fa-rss fa-stack-1x fa-inverse"></i></span></a></li><li><a href="https://twitter.com/DevonBurriss"><span class="fa-stack fa-lg"><i class="fa fa-circle fa-stack-2x"></i><i class="fa fa-twitter fa-stack-1x fa-inverse"></i></span></a></li><li><a href="https://github.com/dburriss"><span class="fa-stack fa-lg"><i class="fa fa-circle fa-stack-2x"></i><i class="fa fa-github fa-stack-1x fa-inverse"></i></span></a></li></ul><span style="display:contents"><h2><i class="glyphicon glyphicon-th-list"></i>  Topics</h2><a class="badge badge-info" href="/topics/software-design/" title="Architecture, design, modeling, and distributed systems."><span class="site-topic">Software Design</span></a><a class="badge badge-info" href="/topics/engineering-practices/" title="How we build, test, and validate software."><span class="site-topic">Engineering Practices</span></a><a class="badge badge-info" href="/topics/platforms-runtime/" title="Runtimes and execution environments (not frameworks)."><span class="site-topic">Platforms &amp; Runtime</span></a><a class="badge badge-info" href="/topics/tooling-automation/" title="Build tooling, CI/CD, editors, and developer automation."><span class="site-topic">Tooling &amp; Automation</span></a><a class="badge badge-info" href="/topics/reliability-observability/" title="Monitoring, metrics, reliability, and failure modes."><span class="site-topic">Reliability &amp; Observability</span></a><a class="badge badge-info" href="/topics/ai-agentic-systems/" title="AI, LLMs, and agentic workflows."><span class="site-topic">AI &amp; Agentic Systems</span></a><a class="badge badge-info" href="/topics/leadership-teams/" title="Human systems around software development."><span class="site-topic">Leadership &amp; Teams</span></a><a class="badge badge-info" href="/topics/notes-reflections/" title="Learning, career, ethics, and life-adjacent thinking."><span class="site-topic">Notes &amp; Reflections</span></a></span></div></div></div><hr></article><span style="display:contents"><footer><div class="container"><div class="row"><div class="col-lg-8 col-lg-offset-2 col-md-10 col-md-offset-1"><p class="copyright text-muted">Copyright &#169; <a href="/about.html">Devon Burriss</a> 2026</p></div></div></div></footer><script src="/js/jquery.min.js"></script><script src="/js/bootstrap.min.js"></script><script src="/js/clean-blog.min.js"></script><script src="/js/highlight.pack.js"></script><script>hljs.initHighlightingOnLoad();</script></span><script>(function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){(i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)})(window,document,'script','//www.google-analytics.com/analytics.js','ga');ga('create', 'UA-45750611-2', 'auto');ga('send', 'pageview');</script><div class="container-fluid"><div id="disqus_thread"></div><script type="text/javascript">var disqus_shortname = 'devonburriss';(function() { var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;dsq.src = 'https://devonburriss.disqus.com/embed.js';(document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);})();</script><noscript>Please enable JavaScript to view the comments powered by Disqus.</noscript></div></body></html>