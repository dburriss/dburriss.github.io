<!DOCTYPE html>
<html lang="en"><head><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1"><meta name="color-scheme" content="dark light"><title>Local Prometheus setup</title><meta name="description" content="Using docker to run a local Prometheus instance for testing."><meta name="author" content="Devon Burriss"><meta itemprop="name" content="Local Prometheus setup"><meta itemprop="description" content="Using docker to run a local Prometheus instance for testing."><meta itemprop="image" content="https://devonburriss.me/img/posts/2020/flame-500.jpg"><link rel="canonical" href="https://devonburriss.me/local-prometheus-setup/"><meta itemprop="datePublished" content="2021-01-30" id="date"><meta itemprop="dateModified" content="2021-01-30" id="mdate"><meta itemprop="headline" content="Local Prometheus setup - Setting up Prometheus locally with Docker"><meta itemprop="mainEntityOfPage" content="https://devonburriss.me/local-prometheus-setup/"><meta name="headline" content="Local Prometheus setup - Setting up Prometheus locally with Docker"><link rel="icon" type="image/png" href="/img/favicon16.png" sizes="16x16"><link rel="icon" type="image/png" href="/img/favicon32.png" sizes="32x32"><meta name="twitter:card" content="summary_large_image"><meta name="twitter:site" content="@DevonBurriss"><meta name="twitter:title" content="Local Prometheus setup"><meta name="twitter:description" content="Using docker to run a local Prometheus instance for testing."><meta name="twitter:creator" content="@DevonBurriss"><meta name="twitter:image" content="https://devonburriss.me/img/posts/2020/flame-500.jpg"><meta property="og:title" content="Local Prometheus setup"><meta property="og:type" content="article"><meta property="og:url" content="https://devonburriss.me/local-prometheus-setup/"><meta property="og:image" content="https://devonburriss.me/img/posts/2020/flame-500.jpg"><meta property="og:description" content="Using docker to run a local Prometheus instance for testing."><meta property="og:site_name" content="Devon Burriss&#39; Blog"><link rel="stylesheet" href="/css/site.css"><link rel="stylesheet" href="/css/highlight/atom-one-dark.css"><script>(function(){try{var t=localStorage.getItem('theme');if(t==='dark'||t==='light'){document.documentElement.dataset.theme=t;}}catch(e){}})();</script><script src="/js/theme.js" defer="defer"></script></head><body><header class="site-header"><nav class="site-nav"><ul class="site-links"><li><a href="/">Home</a></li><li><a href="/topics/">Topics</a></li><li><a href="/recommended-reading.html">Reading</a></li><li><a href="/about/">About</a></li><li><a href="/rss.xml">RSS</a></li></ul><button type="button" class="theme-toggle" id="theme-toggle" aria-label="Toggle light/dark theme">Theme</button></nav></header><main class="site-main"><span style="display:contents"><header class="page-header"><h1>Local Prometheus setup</h1><p class="page-subtitle">Setting up Prometheus locally with Docker</p><p class="post-meta">Devon Burriss &#183; Jan 30, 2021</p></header><div class="topic-pills"><a class="topic-pill" href="/topics/reliability-observability/" title="Monitoring, metrics, reliability, and failure modes.">Reliability &amp; Observability</a><a class="topic-pill" href="/topics/tooling-automation/" title="Build tooling, CI/CD, editors, and developer automation.">Tooling &amp; Automation</a></div><hr></span><article class="prose"><p>It is useful to have a local Prometheus instance running to test the instrumentation of your application. If you are running the application on your machine, you need to make sure the Prometheus container can talk to the host machine. This is a short post detailing this setup.</p>
<!--more-->
<h2 id="configuration">Configuration</h2>
<p>Firstly, let's create a Prometheus configuration with the needed <a href="https://prometheus.io/docs/prometheus/latest/configuration/configuration/#scrape_config">scrape config</a>.</p>
<pre><code class="language-yaml"># A list of scrape configurations.
scrape_configs:
  # The job name assigned to scraped metrics by default.
  - job_name: 'fennel-metricsdemo'

    # How frequently to scrape targets from this job.
    scrape_interval: 5s
    
    # The HTTP resource path on which to fetch metrics from targets.
    metrics_path: &quot;/api/metrics&quot;

    # List of labeled statically configured targets for this job.
    static_configs:
      # The targets specified by the static config.
      - targets: ['host.docker.internal:7071']
        # Labels assigned to all metrics scraped from the targets.
        labels:
          app: 'demo-app'
</code></pre>
<p>Since we are running this locally, you need to target your local machine. With Docker on Mac I had to target <code>host.docker.internal</code> and my application (an Azure Function) is running locally on port 7071.</p>
<p>Now that we have our configuration, we can use this to start our Docker container, mounting the configuration as a volume.</p>
<pre><code class="language-bash">docker run --rm -it -p 9090:9090 -v /path/to/your/prometheus.yml:/etc/prometheus/prometheus.yml prom/prometheus
</code></pre>
<p>Prometheus should now be up and running and if your application is emitting metrics, you can go see them by navigating to http://localhost:9090/graph.</p>
<p><img src="../img/posts/2020/prometheus_sale_count.png" alt="" /></p>
<h2 id="conclusion">Conclusion</h2>
<p>I will be making use of this in an upcoming post I plan to release soon. In my <a href="/prometheus-datadog-agent">next post</a> though I will look at using Datadog instead of a Prometheus server. I hope you find this useful.</p>
<p><span>Photo by <a href="https://unsplash.com/@_ggleee?utm_source=unsplash&amp;utm_medium=referral&amp;utm_content=creditCopyText">Gleb Lukomets</a> on <a href="https://unsplash.com/s/photos/flame?utm_source=unsplash&amp;utm_medium=referral&amp;utm_content=creditCopyText">Unsplash</a></span></p>
</article><hr><nav class="pager"><ul class="pager-links"><li><a href="/meaning-of-meditation/" title="The meaning of meditation">← Previous</a></li><li><a href="/prometheus-datadog-agent/" title="Prometheus Datadog Agent">Next →</a></li></ul></nav></main><footer class="site-footer"><p>Copyright &#169; <a href="/about/">Devon Burriss</a> 2026</p></footer><div class="comments"><div id="disqus_thread"></div><script type="text/javascript">var disqus_shortname = 'devonburriss';(function() { var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;dsq.src = 'https://devonburriss.disqus.com/embed.js';(document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);})();</script><noscript>Please enable JavaScript to view the comments powered by Disqus.</noscript></div><script src="/js/highlight.pack.js"></script><script>hljs.initHighlightingOnLoad();</script><script>(function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){(i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)})(window,document,'script','//www.google-analytics.com/analytics.js','ga');ga('create', 'UA-45750611-2', 'auto');ga('send', 'pageview');</script></body></html>